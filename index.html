<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StarCadet: Space Academy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&family=Teko:wght@300;400;500;600;700&family=Noto+Sans+Devanagari:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* Custom Space Styles */
        :root {
            --space-black: #050b14;
            --space-blue: #0f172a;
            --neon-cyan: #22d3ee;
            --neon-purple: #a855f7;
            --neon-gold: #fbbf24;
            --glass-bg: rgba(15, 23, 42, 0.85);
            --glass-border: rgba(34, 211, 238, 0.2);
        }

        body {
            background-color: var(--space-black);
            font-family: 'Rajdhani', 'Noto Sans Devanagari', sans-serif;
            color: white;
            overflow-x: hidden;
            cursor: none;
        }

        /* Custom Cursor */
        #cursor-dot, #cursor-ring {
            position: fixed;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 9999;
            transform: translate(-50%, -50%);
            border-radius: 50%;
        }
        #cursor-dot {
            width: 8px;
            height: 8px;
            background: var(--neon-cyan);
            box-shadow: 0 0 10px var(--neon-cyan);
        }
        #cursor-ring {
            width: 40px;
            height: 40px;
            border: 1px solid rgba(34, 211, 238, 0.5);
            transition: width 0.2s, height 0.2s, background-color 0.2s;
        }
        body.hovering #cursor-ring {
            width: 60px;
            height: 60px;
            background-color: rgba(34, 211, 238, 0.1);
            border-color: var(--neon-cyan);
        }

        /* Sci-Fi Headers */
        h1, h2, h3, h4, .orbitron {
            font-family: 'Orbitron', 'Teko', sans-serif;
            letter-spacing: 0.05em;
        }

        .lang-hi h1, .lang-hi h2, .lang-hi h3 {
            font-family: 'Teko', sans-serif;
            font-weight: 500;
            letter-spacing: 0.02em;
        }
        .lang-hi p, .lang-hi button {
            font-family: 'Noto Sans Devanagari', sans-serif;
        }

        /* Cyber Grid Overlay */
        .cyber-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 200vw;
            height: 200vh;
            background: 
                linear-gradient(rgba(34, 211, 238, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(34, 211, 238, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: -1;
            transform: perspective(500px) rotateX(60deg) translateY(-100px) translateZ(-200px);
            animation: grid-move 20s linear infinite;
        }

        @keyframes grid-move {
            0% { transform: perspective(500px) rotateX(60deg) translateY(0) translateZ(-200px); }
            100% { transform: perspective(500px) rotateX(60deg) translateY(50px) translateZ(-200px); }
        }

        #star-canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: -2;
            pointer-events: none;
        }

        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 0 15px rgba(34, 211, 238, 0.1), inset 0 0 20px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
        }
        
        .glass-panel::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, transparent, rgba(34, 211, 238, 0.05), transparent);
            transform: translateY(-100%);
            animation: scanline 4s linear infinite;
            pointer-events: none;
        }

        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }

        .stagger-item {
            opacity: 0;
            transform: translateY(20px);
            animation: stagger-slide-up 0.5s forwards ease-out;
        }
        
        @keyframes stagger-slide-up {
            to { opacity: 1; transform: translateY(0); }
        }

        .clip-corners {
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
        }

        .neon-text-cyan { text-shadow: 0 0 10px rgba(34, 211, 238, 0.8); }
        .neon-text-purple { text-shadow: 0 0 10px rgba(168, 85, 247, 0.8); }

        @keyframes pulse-glow {
            0% { box-shadow: 0 0 0 0 rgba(34, 211, 238, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(34, 211, 238, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 211, 238, 0); }
        }
        .animate-pulse-glow { animation: pulse-glow 2s infinite; }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .animate-float { animation: float 4s ease-in-out infinite; }

        .fade-enter {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .fade-enter-active {
            opacity: 1;
            transform: translateY(0);
        }

        #warp-overlay {
            position: fixed;
            inset: 0;
            background: black;
            z-index: 200;
            display: none;
            opacity: 0;
            transition: opacity 0.5s;
        }
        #warp-overlay.active { display: flex; opacity: 1; }

        .lang-switch {
            position: relative;
            display: inline-flex;
            background: rgba(0,0,0,0.5);
            border: 1px solid var(--neon-cyan);
            border-radius: 4px;
            overflow: hidden;
            cursor: pointer;
        }
        .lang-option {
            padding: 4px 12px;
            font-size: 0.8rem;
            font-weight: bold;
            transition: all 0.3s;
        }
        .lang-option.active {
            background: var(--neon-cyan);
            color: black;
            box-shadow: 0 0 10px var(--neon-cyan);
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; border: 1px solid var(--neon-cyan); }
        ::-webkit-scrollbar-thumb:hover { background: #22d3ee; }

        .planet-visual {
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #4f46e5, #0f172a);
            box-shadow: inset -10px -10px 20px rgba(0,0,0,0.8), 0 0 20px rgba(79, 70, 229, 0.5);
            transition: transform 0.5s ease;
        }
        .planet-visual:hover { transform: scale(1.05) rotate(5deg); }

        .hidden-section { display: none; }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- Custom Cursor -->
    <div id="cursor-dot"></div>
    <div id="cursor-ring"></div>

    <!-- Backgrounds -->
    <canvas id="star-canvas"></canvas>
    <div class="cyber-grid"></div>

    <!-- Warp Animation Overlay -->
    <div id="warp-overlay" class="items-center justify-center flex-col">
        <div class="text-cyan-400 text-3xl orbitron tracking-widest animate-pulse mb-4" id="warp-text">INITIATING WARP DRIVE...</div>
        <div class="w-64 h-2 bg-slate-800 rounded-full overflow-hidden border border-cyan-900">
            <div class="h-full bg-cyan-400 w-full animate-pulse shadow-[0_0_10px_#22d3ee]"></div>
        </div>
    </div>

    <!-- Rank Up Modal -->
    <div id="rank-modal" class="fixed inset-0 z-[300] bg-black/95 backdrop-blur-xl hidden flex items-center justify-center p-4">
        <div class="text-center animate-float">
            <!-- Animated Badge -->
            <div class="relative mb-8 inline-block">
                 <div class="absolute inset-0 animate-ping opacity-30 rounded-full bg-yellow-400"></div>
                 <div class="absolute inset-0 animate-pulse opacity-50 rounded-full bg-yellow-400 blur-xl"></div>
                 <i class="ph-fill ph-medal-military text-9xl text-yellow-400 relative z-10 drop-shadow-[0_0_30px_rgba(250,204,21,0.8)]"></i>
            </div>
            <h2 class="text-5xl md:text-7xl font-black text-white mb-2 orbitron tracking-widest uppercase neon-text-gold">PROMOTION</h2>
            <p class="text-gray-400 text-xl mb-8 font-mono tracking-widest" id="rank-modal-subtitle">NEW RANK ASSIGNED</p>
            
            <div class="text-3xl md:text-5xl font-bold text-yellow-400 mb-10 border-y-2 border-yellow-400/30 py-6 bg-yellow-400/5 orbitron" id="new-rank-name">
                STAR VOYAGER
            </div>
            
            <button onclick="app.closeRankModal()" class="px-10 py-4 bg-yellow-500 hover:bg-yellow-400 text-black font-bold text-xl clip-corners transition-all shadow-[0_0_20px_rgba(234,179,8,0.5)] flex items-center gap-2 mx-auto">
                <i class="ph-bold ph-check"></i> ACKNOWLEDGE
            </button>
        </div>
    </div>

    <!-- Navigation Bar -->
    <nav class="fixed top-0 w-full z-50 glass-panel border-b border-cyan-500/30 px-6 py-4">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3 cursor-pointer group" onclick="app.goHome()">
                <i class="ph-fill ph-rocket-launch text-3xl text-cyan-400 group-hover:-translate-y-1 transition-transform drop-shadow-[0_0_5px_rgba(34,211,238,0.8)]"></i>
                <div class="flex flex-col">
                    <span class="orbitron font-bold text-xl tracking-wider text-white neon-text-cyan">STAR<span class="text-cyan-400">CADET</span></span>
                    <span class="text-xs text-gray-400 tracking-widest uppercase" id="nav-subtitle">Space Academy</span>
                </div>
            </div>
            
            <div class="flex items-center gap-6">
                <!-- Language Toggle -->
                <div class="lang-switch" onclick="app.toggleLanguage()">
                    <div class="lang-option active" id="btn-en">EN</div>
                    <div class="lang-option" id="btn-hi">HI</div>
                </div>

                <button onclick="app.resetProgress()" id="btn-reset" class="hidden md:block text-xs text-red-400 hover:text-red-300 uppercase tracking-wider border border-red-500/30 px-3 py-1 rounded bg-red-900/10 hover:bg-red-900/30 transition-colors">Reset Data</button>
                
                <div class="flex flex-col items-end">
                    <span class="text-xs text-gray-400 uppercase" id="label-rank">Current Rank</span>
                    <span id="rank-display" class="font-bold font-mono transition-colors duration-500">Rookie Cadet</span>
                </div>
                
                <!-- Profile Icon with Dynamic Glow -->
                <div id="profile-container" class="w-12 h-12 rounded-full bg-slate-800 border-2 flex items-center justify-center relative overflow-hidden transition-all duration-500">
                    <i class="ph-fill ph-user-astronaut text-2xl text-white relative z-10"></i>
                    <div id="profile-glow" class="absolute inset-0 opacity-50 blur-md"></div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main id="main-container" class="flex-grow pt-24 px-4 pb-12 relative z-10">
        
        <!-- View: Intro / Landing -->
        <section id="intro-view" class="h-[80vh] flex flex-col items-center justify-center text-center fade-enter-active relative">
            <div class="mb-8 relative group animate-float z-10">
                <div class="absolute -inset-1 bg-gradient-to-r from-cyan-400 to-purple-600 rounded-full blur opacity-25 group-hover:opacity-75 transition duration-1000 group-hover:duration-200"></div>
                <div class="relative w-48 h-48 md:w-64 md:h-64 rounded-full bg-black flex items-center justify-center planet-visual border-4 border-slate-800/80 backdrop-blur-sm">
                    <i class="ph-duotone ph-planet text-8xl text-white/90"></i>
                </div>
            </div>
            <h1 id="landing-title" class="text-5xl md:text-8xl font-black mb-4 tracking-tight neon-text-cyan z-10">EXPLORE THE COSMOS</h1>
            <p id="landing-subtitle" class="text-xl md:text-2xl text-gray-300 max-w-2xl mb-10 font-light z-10 drop-shadow-md">
                Your journey from Earth to the edge of the universe begins here. Complete missions, analyze data, and earn your wings.
            </p>
            <button onclick="app.startJourney()" id="btn-start" class="z-10 group relative px-8 py-4 bg-cyan-500/10 hover:bg-cyan-500/20 border border-cyan-400 text-cyan-300 font-bold text-xl rounded-none clip-corners transition-all shadow-[0_0_20px_rgba(34,211,238,0.2)] hover:shadow-[0_0_40px_rgba(34,211,238,0.5)] flex items-center gap-3 backdrop-blur-md">
                <i class="ph-bold ph-paper-plane-tilt group-hover:translate-x-1 transition-transform"></i>
                <span class="tracking-widest">START MISSION</span>
            </button>
        </section>

        <!-- View: Mission Dashboard -->
        <section id="dashboard-view" class="hidden-section max-w-5xl mx-auto">
            <div class="text-center mb-16 relative stagger-item" style="animation-delay: 0ms">
                <div class="absolute top-1/2 left-0 w-full h-px bg-gradient-to-r from-transparent via-cyan-900 to-transparent"></div>
                <h2 id="dashboard-title" class="text-4xl font-bold mb-2 text-white bg-space-black inline-block px-6 relative z-10 neon-text-cyan">MISSION CONTROL</h2>
                <p id="dashboard-subtitle" class="text-gray-400 mt-2">Select your destination. Complete missions sequentially to unlock deeper space.</p>
            </div>

            <div class="relative py-10">
                <div class="absolute left-1/2 top-0 bottom-0 w-0.5 bg-gradient-to-b from-transparent via-cyan-900 to-transparent -translate-x-1/2 hidden md:block"></div>
                <div id="mission-list" class="space-y-12 relative"></div>
            </div>
        </section>

        <!-- View: Mission Details -->
        <section id="mission-detail-view" class="hidden-section max-w-6xl mx-auto">
            <button onclick="app.showDashboard()" id="btn-back" class="mb-6 flex items-center gap-2 text-gray-400 hover:text-cyan-400 transition-colors group px-4 py-2 border border-transparent hover:border-cyan-500/30 rounded stagger-item" style="animation-delay: 0ms">
                <i class="ph-bold ph-caret-left group-hover:-translate-x-1 transition-transform"></i> Return to Star Map
            </button>
            <div id="mission-content-area"></div>
        </section>
    </main>

    <!-- Modal for Quizzes -->
    <div id="quiz-modal" class="fixed inset-0 z-[100] bg-black/90 backdrop-blur-md hidden flex items-center justify-center p-4">
        <div class="glass-panel max-w-lg w-full rounded-none border border-cyan-500/50 p-8 relative animate-float shadow-[0_0_50px_rgba(34,211,238,0.1)] clip-corners">
            <button onclick="app.closeQuiz()" class="absolute top-4 right-4 text-gray-400 hover:text-white"><i class="ph-bold ph-x text-xl"></i></button>
            
            <div class="text-center mb-6">
                <!-- Progress Bar -->
                <div class="w-full h-1 bg-slate-800 rounded-full mb-4 overflow-hidden">
                    <div id="quiz-progress" class="h-full bg-cyan-400 transition-all duration-300" style="width: 0%"></div>
                </div>
                
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-cyan-500/10 text-cyan-400 mb-4 border border-cyan-500 shadow-[0_0_15px_rgba(34,211,238,0.3)]"><i class="ph-fill ph-brain text-3xl"></i></div>
                <h3 id="quiz-title" class="text-2xl font-bold orbitron text-white tracking-widest">SYSTEM CHECK</h3>
                <p id="quiz-subtitle" class="text-gray-400 text-sm font-mono">Verify knowledge to update mission log.</p>
            </div>
            
            <div id="quiz-question-container"></div>
            <div id="quiz-feedback" class="hidden mt-6 text-center p-4 bg-white/5 border border-white/10"></div>
        </div>
    </div>

    <!-- Modal for Item Details -->
    <div id="detail-modal" class="fixed inset-0 z-[100] bg-black/95 backdrop-blur-xl hidden flex items-center justify-center p-4">
        <div class="glass-panel max-w-3xl w-full overflow-hidden relative shadow-2xl shadow-cyan-900/40 border border-cyan-500/30 flex flex-col md:flex-row clip-corners stagger-item">
            <button onclick="app.closeDetail()" class="absolute top-4 right-4 z-50 text-white bg-black/50 hover:bg-red-500/80 w-8 h-8 flex items-center justify-center transition-colors border border-white/20"><i class="ph-bold ph-x"></i></button>
            <div id="detail-content" class="contents"></div>
        </div>
    </div>

    <script>
        const i18n = {
            en: {
                navSubtitle: "Space Academy", resetData: "Reset Data", currentRank: "Current Rank",
                warpText: "INITIATING WARP DRIVE...", landingTitle: "EXPLORE THE COSMOS",
                landingSubtitle: "Your journey from Earth to the edge of the universe begins here. Complete missions, analyze data, and earn your wings.",
                startBtn: "START MISSION", dashboardTitle: "MISSION CONTROL", dashboardSubtitle: "Select your destination. Complete missions sequentially to unlock deeper space.",
                missionPrefix: "MISSION", locked: "Clearance Required", startMission: "START MISSION", accessLog: "ACCESS LOG",
                backToMap: "Return to Star Map", practice: "Practice Simulation", complete: "Complete Mission",
                quizTitle: "SYSTEM CHECK", quizSubtitle: "Verify knowledge to update mission log.", verified: "CORRECT",
                verifiedMsg: "Excellent work, Cadet.", error: "INCORRECT", errorMsg: "Data mismatch. Review and retry.",
                retry: "Retry Question", nextMission: "Next Mission", close: "Close", systemAnalysis: "System Analysis",
                ranks: ["Rookie Cadet", "Star Voyager", "Stellar Engineer", "Galactic Pilot", "Cosmic Guardian"],
                rankUpTitle: "PROMOTION", rankUpSub: "NEW RANK ASSIGNED",
                nextQ: "Next Question", finishQ: "Complete Module", intel: "INTEL DATA"
            },
            hi: {
                navSubtitle: "अंतरिक्ष अकादमी", resetData: "डेटा रीसेट करें", currentRank: "वर्तमान रैंक",
                warpText: "वार्प ड्राइव शुरू हो रहा है...", landingTitle: "ब्रह्मांड की खोज",
                landingSubtitle: "पृथ्वी से ब्रह्मांड के किनारे तक की आपकी यात्रा यहाँ शुरू होती है। मिशन पूरे करें, डेटा का विश्लेषण करें और अपनी रैंक बढ़ाएं।",
                startBtn: "मिशन शुरू करें", dashboardTitle: "मिशन कंट्रोल", dashboardSubtitle: "अपना गंतव्य चुनें। गहरे अंतरिक्ष को अनलॉक करने के लिए क्रमिक रूप से मिशन पूरे करें।",
                missionPrefix: "मिशन", locked: "अनुमति आवश्यक है", startMission: "मिशन शुरू करें", accessLog: "लॉग देखें",
                backToMap: "स्टार मैप पर लौटें", practice: "अभ्यास सिमुलेशन", complete: "मिशन पूरा करें",
                quizTitle: "सिस्टम चेक", quizSubtitle: "मिशन लॉग अपडेट करने के लिए ज्ञान का सत्यापन करें।", verified: "सही जवाब",
                verifiedMsg: "बहुत बढ़िया, कैडेट।", error: "गलत जवाब", errorMsg: "गलत डेटा। पुनः प्रयास करें।",
                retry: "पुनः प्रयास करें", nextMission: "अगला मिशन", close: "बंद करें", systemAnalysis: "सिस्टम विश्लेषण",
                ranks: ["रकी कैडेट", "स्टार वॉयेजर", "स्टेलर इंजीनियर", "गेलेक्टिक पायलट", "कोस्मिक गार्जियन"],
                rankUpTitle: "पदोन्नति", rankUpSub: "नई रैंक मिली",
                nextQ: "अगला प्रश्न", finishQ: "मॉड्यूल समाप्त", intel: "खुफिया डेटा"
            }
        };

        const missionsData = {
            en: [
                {
                    id: 1, title: "The Solar Neighborhood", subtitle: "Planets & Moons", icon: "ph-planet", color: "cyan",
                    description: "Start your engines! We begin right here at home. Analyze the rocky inner worlds and the gas giants that make up our Solar System.",
                    content: {
                        intro: "Our Solar System formed 4.6 billion years ago. It consists of eight planets, dozens of moons, and millions of asteroids.",
                        sections: [
                            {
                                title: "Inner Planets", text: "The four inner planets are compact, rocky, and have few moons.",
                                cards: [
                                    { name: "Mercury", detail: "A sweltering world of extremes.", icon: "ph-circle", type: "Terrestrial", stats: {"Gravity": "3.7 m/s²", "Temp": "430°C", "Year": "88 Days"} },
                                    { name: "Venus", detail: "Hottest planet due to greenhouse effect.", icon: "ph-cloud-fog", type: "Terrestrial", stats: {"Gravity": "8.87 m/s²", "Temp": "464°C", "Day": "243 Days"} },
                                    { name: "Earth", detail: "Our oasis in the void.", icon: "ph-globe-hemisphere-west", type: "Terrestrial", stats: {"Gravity": "9.8 m/s²", "Moons": "1", "Water": "71%"} },
                                    { name: "Mars", detail: "The Red Planet.", icon: "ph-planet", type: "Terrestrial", stats: {"Gravity": "3.71 m/s²", "Temp": "-65°C", "Moons": "2"} }
                                ]
                            },
                            {
                                title: "Outer Giants", text: "Beyond the asteroid belt lie the giants. Massive worlds with deep atmospheres.",
                                cards: [
                                    { name: "Jupiter", detail: "King of Planets.", icon: "ph-planet", type: "Gas Giant", stats: {"Gravity": "24.79 m/s²", "Moons": "95+", "Day": "9h 55m"} },
                                    { name: "Saturn", detail: "The Jewel with rings.", icon: "ph-record", type: "Gas Giant", stats: {"Gravity": "10.44 m/s²", "Moons": "146+", "Rings": "Yes"} },
                                    { name: "Uranus", detail: "Rolls on its side.", icon: "ph-circle-notch", type: "Ice Giant", stats: {"Temp": "-224°C", "Tilt": "98°", "Moons": "27"} },
                                    { name: "Neptune", detail: "Winds reach 1,200 mph.", icon: "ph-wind", type: "Ice Giant", stats: {"Temp": "-200°C", "Wind": "2100 km/h", "Moons": "14"} }
                                ]
                            }
                        ]
                    },
                    quiz: [
                        { question: "Which planet is closest to the Sun?", options: ["Venus", "Mercury", "Mars", "Earth"], correct: 1, explanation: "Mercury is the smallest and innermost planet in the Solar System." },
                        { question: "Which planet is known as the 'Red Planet'?", options: ["Jupiter", "Mars", "Saturn", "Venus"], correct: 1, explanation: "Mars appears red because of iron oxide (rust) on its surface." },
                        { question: "Which is the largest planet in our solar system?", options: ["Saturn", "Jupiter", "Neptune", "Uranus"], correct: 1, explanation: "Jupiter is a gas giant with a mass more than two and a half times that of all the other planets combined." },
                        { question: "Which planet is famous for its extensive ring system?", options: ["Uranus", "Jupiter", "Saturn", "Neptune"], correct: 2, explanation: "While other gas giants have rings, Saturn's are the most extensive and visible." },
                        { question: "Which planet rotates on its side?", options: ["Mars", "Uranus", "Venus", "Earth"], correct: 1, explanation: "Uranus has an axial tilt of 98 degrees, likely due to a massive ancient collision." }
                    ]
                },
                {
                    id: 2, title: "Stellar Engines", subtitle: "The Life of Stars", icon: "ph-star", color: "neon-gold",
                    description: "Leave the planets behind. Discover how stars are born, how they live, and their spectacular deaths.",
                    content: {
                        intro: "Stars are huge celestial bodies made of hydrogen and helium that produce light and heat from nuclear fusion.",
                        sections: [
                            {
                                title: "Stellar Classification", text: "Stars are classified by color and temperature.",
                                cards: [
                                    { name: "Red Dwarf", detail: "Small, cool, lives for trillions of years.", icon: "ph-sparkle", type: "Star Type M", stats: {"Temp": "3,000 K", "Life": "Trillions", "Mass": "Low"} },
                                    { name: "Yellow Dwarf", detail: "Like our Sun.", icon: "ph-sun", type: "Star Type G", stats: {"Temp": "5,500 K", "Life": "10B Yrs", "Mass": "Medium"} },
                                    { name: "Blue Giant", detail: "Massive, extremely hot.", icon: "ph-star-four", type: "Star Type O", stats: {"Temp": "30,000 K", "Life": "10M Yrs", "Mass": "High"} }
                                ]
                            },
                            {
                                title: "Cosmic Lifecycle", text: "From dust to dust.",
                                cards: [
                                    { name: "Nebula", detail: "Star nursery.", icon: "ph-cloud", type: "Birth", stats: {"Size": "Light Years", "Comp": "Gas/Dust", "Role": "Nursery"} },
                                    { name: "Supernova", detail: "Explosive death.", icon: "ph-explosion", type: "Death", stats: {"Energy": "Huge", "Result": "Neutron Star", "Light": "Blinding"} },
                                    { name: "Black Hole", detail: "Gravity infinite.", icon: "ph-vinyl-record", type: "Remnant", stats: {"Gravity": "Infinite", "Size": "Singularity", "Time": "Warps"} }
                                ]
                            }
                        ]
                    },
                    quiz: [
                        { question: "What fuel do stars primarily burn?", options: ["Oxygen", "Carbon", "Hydrogen", "Nitrogen"], correct: 2, explanation: "Stars fuse Hydrogen atoms into Helium in their cores to create energy." },
                        { question: "What is the most common type of star in the universe?", options: ["Blue Giant", "Red Dwarf", "Yellow Dwarf", "Supergiant"], correct: 1, explanation: "Red Dwarfs are small, cool, and make up about 75% of all stars." },
                        { question: "What is the explosive death of a massive star called?", options: ["Nebula", "Fusion", "Supernova", "Solar Flare"], correct: 2, explanation: "A Supernova is a powerful and luminous stellar explosion." },
                        { question: "What forms when a massive star collapses with infinite gravity?", options: ["Black Hole", "Neutron Star", "White Dwarf", "Planet"], correct: 0, explanation: "A Black Hole's gravity is so strong that not even light can escape it." },
                        { question: "Where are stars born?", options: ["Asteroid Field", "Nebula", "Black Hole", "Comet"], correct: 1, explanation: "Nebulas are giant clouds of dust and gas where gravity pulls matter together to form stars." }
                    ]
                },
                {
                    id: 3, title: "Galactic Voyage", subtitle: "Galaxies & The Universe", icon: "ph-infinity", color: "purple",
                    description: "Zoom out. Way out. We are just one of billions of galaxies. Let's look at the grand structure.",
                    content: {
                        intro: "A galaxy is a gravitationally bound system of stars, stellar remnants, interstellar gas, dust, and dark matter.",
                        sections: [
                            {
                                title: "The Milky Way", text: "Our home galaxy.",
                                cards: [{name: "Milky Way", detail: "Barred Spiral Galaxy", icon: "ph-spiral", type: "Galaxy", stats: {"Stars": "400B", "Width": "100k LY"}}]
                            }
                        ]
                    },
                    quiz: [
                        { question: "What is the name of our home galaxy?", options: ["Andromeda", "Triangulum", "Milky Way", "Whirlpool"], correct: 2, explanation: "We live in the Milky Way, a barred spiral galaxy." },
                        { question: "What shape is the Milky Way galaxy?", options: ["Elliptical", "Spiral", "Irregular", "Round"], correct: 1, explanation: "It is a spiral galaxy with rotating arms containing stars and gas." },
                        { question: "What is at the center of most large galaxies?", options: ["A Sun", "A Supermassive Black Hole", "A Planet", "A Nebula"], correct: 1, explanation: "Sagittarius A* is the supermassive black hole at the center of our galaxy." },
                        { question: "Which major galaxy is on a collision course with ours?", options: ["Andromeda", "Magellanic Cloud", "Triangulum", "Sombrero"], correct: 0, explanation: "Andromeda will collide with the Milky Way in about 4.5 billion years." },
                        { question: "What force holds a galaxy together?", options: ["Magnetism", "Electricity", "Gravity", "Friction"], correct: 2, explanation: "Gravity binds the stars, gas, and dark matter of a galaxy together." }
                    ]
                },
                {
                    id: 4, title: "Human Explorers", subtitle: "Satellites & Travel", icon: "ph-rocket", color: "green",
                    description: "How do we get there? Explore the technology that allows humans to leave Earth.",
                    content: {
                        intro: "Space exploration is the use of astronomy and space technology to explore outer space.",
                        sections: [
                            {
                                title: "Missions", text: "Brave souls venturing into the void.",
                                cards: [{name: "Apollo 11", detail: "First Moon Landing", icon: "ph-flag", type: "Mission", stats: {"Year": "1969", "Crew": "3"}}]
                            }
                        ]
                    },
                    quiz: [
                        { question: "Who was the first human to walk on the Moon?", options: ["Buzz Aldrin", "Yuri Gagarin", "Neil Armstrong", "Michael Collins"], correct: 2, explanation: "Neil Armstrong made history on July 20, 1969, during Apollo 11." },
                        { question: "What was the first artificial satellite launched into space?", options: ["Voyager 1", "Sputnik 1", "Hubble", "Explorer 1"], correct: 1, explanation: "The Soviet Union launched Sputnik 1 in 1957, starting the Space Age." },
                        { question: "Which space station is currently in orbit with a rotating crew?", options: ["Mir", "Skylab", "ISS (International Space Station)", "Tiangong"], correct: 2, explanation: "The ISS is a multinational collaborative project involving 5 space agencies." },
                        { question: "What was the name of the mission that first landed humans on the Moon?", options: ["Apollo 13", "Apollo 11", "Gemini 4", "Artemis 1"], correct: 1, explanation: "Apollo 11 successfully landed Armstrong and Aldrin on the lunar surface." },
                        { question: "Which robotic vehicle is used to explore the surface of Mars?", options: ["Orbiter", "Lander", "Rover", "Satellite"], correct: 2, explanation: "Rovers like Curiosity and Perseverance drive around Mars to study its geology." }
                    ]
                }
            ],
            hi: [
                {
                    id: 1, title: "सौर मंडल", subtitle: "ग्रह और चंद्रमा", icon: "ph-planet", color: "cyan",
                    description: "अपने इंजन शुरू करें! हम यहीं घर से शुरुआत करते हैं। चट्टानी आंतरिक दुनिया और गैस दिग्गजों का विश्लेषण करें।",
                    content: {
                        intro: "हमारा सौर मंडल 4.6 अरब साल पहले बना था। इसमें आठ ग्रह, दर्जनों चंद्रमा और लाखों क्षुद्रग्रह हमारे सूर्य की परिक्रमा करते हैं।",
                        sections: [
                            {
                                title: "आंतरिक ग्रह", text: "चार आंतरिक ग्रह छोटे और चट्टानी हैं।",
                                cards: [
                                    { name: "बुध (Mercury)", detail: "चरम सीमाओं की दुनिया।", icon: "ph-circle", type: "स्थलीय", stats: {"गुरुत्वाकर्षण": "3.7 m/s²", "तापमान": "430°C", "साल": "88 दिन"} },
                                    { name: "शुक्र (Venus)", detail: "पृथ्वी का जहरीला जुड़वां।", icon: "ph-cloud-fog", type: "स्थलीय", stats: {"गुरुत्वाकर्षण": "8.87 m/s²", "तापमान": "464°C", "दिन": "243 दिन"} },
                                    { name: "पृथ्वी (Earth)", detail: "नीला संगमरमर।", icon: "ph-globe-hemisphere-west", type: "स्थलीय", stats: {"गुरुत्वाकर्षण": "9.8 m/s²", "चंद्रमा": "1", "पानी": "71%"} },
                                    { name: "मंगल (Mars)", detail: "लाल ग्रह।", icon: "ph-planet", type: "स्थलीय", stats: {"गुरुत्वाकर्षण": "3.71 m/s²", "तापमान": "-65°C", "चंद्रमा": "2"} }
                                ]
                            },
                            {
                                title: "बाहरी दिग्गज", text: "क्षुद्रग्रह बेल्ट के परे दिग्गज हैं।",
                                cards: [
                                    { name: "बृहस्पति (Jupiter)", detail: "ग्रहों का राजा।", icon: "ph-planet", type: "गैस जाइंट", stats: {"गुरुत्वाकर्षण": "24.79 m/s²", "चंद्रमा": "95+", "दिन": "9घ 55मि"} },
                                    { name: "शनि (Saturn)", detail: "सौर मंडल का रत्न।", icon: "ph-record", type: "गैस जाइंट", stats: {"गुरुत्वाकर्षण": "10.44 m/s²", "चंद्रमा": "146+", "रिंग्स": "हाँ"} },
                                    { name: "अरुण (Uranus)", detail: "तिरछा ग्रह।", icon: "ph-circle-notch", type: "आइस जाइंट", stats: {"तापमान": "-224°C", "झुकाव": "98°", "चंद्रमा": "27"} },
                                    { name: "वरुण (Neptune)", detail: "हवादार ग्रह।", icon: "ph-wind", type: "आइस जाइंट", stats: {"तापमान": "-200°C", "हवा": "2100 km/h", "चंद्रमा": "14"} }
                                ]
                            }
                        ]
                    },
                    quiz: [
                        { question: "सूर्य के सबसे निकट कौन सा ग्रह है?", options: ["शुक्र", "बुध", "मंगल", "पृथ्वी"], correct: 1, explanation: "बुध सौर मंडल का सबसे छोटा और सबसे अंदरूनी ग्रह है।" },
                        { question: "लाल ग्रह किसे कहा जाता है?", options: ["बृहस्पति", "मंगल", "शनि", "शुक्र"], correct: 1, explanation: "मंगल ग्रह की सतह पर आयरन ऑक्साइड (जंग) के कारण यह लाल दिखाई देता है।" },
                        { question: "सौर मंडल का सबसे बड़ा ग्रह कौन सा है?", options: ["शनि", "बृहस्पति", "वरुण", "अरुण"], correct: 1, explanation: "बृहस्पति एक गैस दानव है जिसका द्रव्यमान अन्य सभी ग्रहों के कुल योग से भी अधिक है।" },
                        { question: "किस ग्रह के चारों ओर सुंदर छल्ले हैं?", options: ["अरुण", "बृहस्पति", "शनि", "वरुण"], correct: 2, explanation: "शनि के छल्ले सबसे व्यापक और स्पष्ट रूप से दिखाई देने वाले हैं।" },
                        { question: "कौन सा ग्रह अपनी तरफ (side) घूमता है?", options: ["मंगल", "अरुण", "शुक्र", "पृथ्वी"], correct: 1, explanation: "अरुण का अक्षीय झुकाव 98 डिग्री है, जो संभवतः एक प्राचीन टकराव के कारण है।" }
                    ]
                },
                {
                    id: 2, title: "तारों की दुनिया", subtitle: "तारों का जीवन", icon: "ph-star", color: "neon-gold",
                    description: "ग्रहों को पीछे छोड़ दें। जानें कि तारे कैसे पैदा होते हैं, वे कैसे जीते हैं और उनकी शानदार मृत्यु।",
                    content: {
                        intro: "तारे हाइड्रोजन और हीलियम से बने विशाल खगोलीय पिंड हैं जो परमाणु संलयन से प्रकाश और गर्मी पैदा करते हैं।",
                        sections: [
                            {
                                title: "तारों का वर्गीकरण", text: "तारों को रंग और तापमान के आधार पर वर्गीकृत किया जाता है।",
                                cards: [
                                    { name: "लाल बौना (Red Dwarf)", detail: "छोटा, ठंडा, सबसे आम तारा।", icon: "ph-sparkle", type: "तारा प्रकार M", stats: {"तापमान": "3,000 K", "जीवन": "खरबों साल", "द्रव्यमान": "कम"} },
                                    { name: "पीला बौना (Yellow Dwarf)", detail: "हमारे सूर्य की तरह।", icon: "ph-sun", type: "तारा प्रकार G", stats: {"तापमान": "5,500 K", "जीवन": "10 अरब", "द्रव्यमान": "मध्यम"} },
                                    { name: "नीला विशाल (Blue Giant)", detail: "विशाल, अत्यंत गर्म।", icon: "ph-star-four", type: "तारा प्रकार O", stats: {"तापमान": "30,000 K", "जीवन": "1 करोड़", "द्रव्यमान": "उच्च"} }
                                ]
                            },
                            {
                                title: "ब्रह्मांडीय जीवनचक्र", text: "धूल से धूल तक।",
                                cards: [
                                    { name: "नेबुला (Nebula)", detail: "तारों की नर्सरी।", icon: "ph-cloud", type: "जन्म", stats: {"आकार": "प्रकाश वर्ष", "रचना": "गैस/धूल", "भूमिका": "नर्सरी"} },
                                    { name: "सुपरनोवा", detail: "एक विशाल तारे की विस्फोटक मृत्यु।", icon: "ph-explosion", type: "मृत्यु", stats: {"ऊर्जा": "विशाल", "परिणाम": "न्यूट्रॉन तारा", "प्रकाश": "चमकदार"} },
                                    { name: "ब्लैक होल", detail: "गुरुत्वाकर्षण इतना मजबूत।", icon: "ph-vinyl-record", type: "अवशेष", stats: {"गुरुत्वाकर्षण": "अनंत", "आकार": "सिंगुलैरिटी", "समय": "Warps"} }
                                ]
                            }
                        ]
                    },
                    quiz: [
                        { question: "तारे मुख्य रूप से कौन सा ईंधन जलाते हैं?", options: ["ऑक्सीजन", "कार्बन", "हाइड्रोजन", "नाइट्रोजन"], correct: 2, explanation: "तारे ऊर्जा बनाने के लिए अपने कोर में हाइड्रोजन परमाणुओं को हीलियम में मिलाते हैं।" },
                        { question: "सबसे सामान्य प्रकार का तारा कौन सा है?", options: ["नीला विशाल", "लाल बौना", "पीला बौना", "सुपरजायंट"], correct: 1, explanation: "लाल बौने छोटे, ठंडे होते हैं और सभी तारों का लगभग 75% हिस्सा बनाते हैं।" },
                        { question: "विशाल तारे की विस्फोटक मृत्यु क्या कहलाती है?", options: ["नेबुला", "फ्यूजन", "सुपरनोवा", "सोलर फ्लेयर"], correct: 2, explanation: "सुपरनोवा एक शक्तिशाली और चमकदार तारकीय विस्फोट है।" },
                        { question: "अनंत गुरुत्वाकर्षण वाला क्षेत्र क्या है?", options: ["ब्लैक होल", "न्यूट्रॉन तारा", "सफेद बौना", "ग्रह"], correct: 0, explanation: "ब्लैक होल का गुरुत्वाकर्षण इतना मजबूत होता है कि प्रकाश भी उससे बच नहीं सकता।" },
                        { question: "तारे कहाँ पैदा होते हैं?", options: ["क्षुद्रग्रह क्षेत्र", "नेबुला", "ब्लैक होल", "धूमकेतु"], correct: 1, explanation: "नेबुला धूल और गैस के विशाल बादल हैं जहाँ गुरुत्वाकर्षण पदार्थ को एक साथ खींचकर तारे बनाता है।" }
                    ]
                },
                {
                    id: 3, title: "आकाशगंगा यात्रा", subtitle: "आकाशगंगाएँ", icon: "ph-infinity", color: "purple", description: "आकाशगंगाओं का अन्वेषण करें।",
                    content: { intro: "आकाशगंगाएँ तारों का समूह हैं।", sections: [{ title: "दुग्धमेखला", text: "हमारा घर।", cards: [{name: "दुग्धमेखला", detail: "सर्पिल", icon: "ph-spiral", type: "आकाशगंगा", stats: {"तारे": "400 अरब"}}]}] },
                    quiz: [
                        { question: "हमारी आकाशगंगा का नाम क्या है?", options: ["एंड्रोमेडा", "त्रिकोण", "दुग्धमेखला (Milky Way)", "भंवर"], correct: 2, explanation: "हम दुग्धमेखला में रहते हैं, जो एक सर्पिल आकाशगंगा है।" },
                        { question: "हमारी आकाशगंगा का आकार कैसा है?", options: ["दीर्घवृत्ताकार", "सर्पिल", "अनियमित", "गोल"], correct: 1, explanation: "यह एक सर्पिल आकाशगंगा है जिसमें तारे और गैस वाली भुजाएँ हैं।" },
                        { question: "अधिकांश आकाशगंगाओं के केंद्र में क्या है?", options: ["एक सूर्य", "एक विशाल ब्लैक होल", "एक ग्रह", "एक नेबुला"], correct: 1, explanation: "हमारी आकाशगंगा के केंद्र में 'सैजिटेरियस ए*' नामक एक सुपरमैसिव ब्लैक होल है।" },
                        { question: "हमारी पड़ोसी आकाशगंगा कौन सी है?", options: ["एंड्रोमेडा", "मैगेलैनिक क्लाउड", "त्रिकोण", "सोम्ब्रेरो"], correct: 0, explanation: "एंड्रोमेडा लगभग 4.5 अरब वर्षों में दुग्धमेखला से टकराएगी।" },
                        { question: "आकाशगंगा को एक साथ क्या रखता है?", options: ["चुंबकत्व", "बिजली", "गुरुत्वाकर्षण", "घर्षण"], correct: 2, explanation: "गुरुत्वाकर्षण आकाशगंगा के तारों, गैस और डार्क मैटर को एक साथ बांधता है।" }
                    ]
                },
                {
                    id: 4, title: "मानव खोजकर्ता", subtitle: "अंतरिक्ष यात्रा", icon: "ph-rocket", color: "green", description: "मानव अंतरिक्ष यात्रा।",
                    content: { intro: "अंतरिक्ष अन्वेषण।", sections: [{ title: "मिशन", text: "बाहर जाना।", cards: [{name: "अपोलो 11", detail: "चाँद पर उतरना", icon: "ph-flag", type: "मिशन", stats: {"साल": "1969"}}]}] },
                    quiz: [
                        { question: "चाँद पर कदम रखने वाला पहला इंसान कौन था?", options: ["बज़ एल्ड्रिन", "यूरी गगारिन", "नील आर्मस्ट्रांग", "माइकल कोलिन्स"], correct: 2, explanation: "नील आर्मस्ट्रांग ने 20 जुलाई, 1969 को अपोलो 11 के दौरान इतिहास रचा था।" },
                        { question: "पहला कृत्रिम उपग्रह कौन सा था?", options: ["वोयाजर 1", "स्पूतनिक 1", "हबल", "एक्सप्लोरर 1"], correct: 1, explanation: "सोवियत संघ ने 1957 में स्पूतनिक 1 लॉन्च किया, जिससे अंतरिक्ष युग की शुरुआत हुई।" },
                        { question: "अंतरिक्ष में रहने के लिए प्रयोगशाला कौन सी है?", options: ["मीर", "स्काईलैब", "ISS (अंतर्राष्ट्रीय अंतरिक्ष स्टेशन)", "तियांगोंग"], correct: 2, explanation: "ISS एक बहुराष्ट्रीय सहयोगी परियोजना है जिसमें 5 अंतरिक्ष एजेंसियां शामिल हैं।" },
                        { question: "चाँद पर उतरने वाले मिशन का नाम क्या था?", options: ["अपोलो 13", "अपोलो 11", "जेमिनी 4", "आर्टेमिस 1"], correct: 1, explanation: "अपोलो 11 ने आर्मस्ट्रांग और एल्ड्रिन को सफलतापूर्वक चंद्र सतह पर उतारा।" },
                        { question: "मंगल ग्रह पर कौन सा रोबोट है?", options: ["ऑर्बिटर", "लैंडर", "रोवर", "उपग्रह"], correct: 2, explanation: "क्यूरियोसिटी और परसेवेरेंस जैसे रोवर मंगल के भूविज्ञान का अध्ययन करने के लिए वहां घूमते हैं।" }
                    ]
                }
            ]
        };

        const app = {
            state: { currentView: 'intro', unlockedMissions: 1, rank: 0, lang: 'en', activeQuiz: null },
            rankColors: [
                { border: 'border-slate-500', text: 'text-slate-400', shadow: 'shadow-none', glow: 'bg-slate-500' }, // Rookie
                { border: 'border-cyan-400', text: 'text-cyan-400', shadow: 'shadow-[0_0_15px_rgba(34,211,238,0.5)]', glow: 'bg-cyan-400' }, // Voyager
                { border: 'border-blue-500', text: 'text-blue-400', shadow: 'shadow-[0_0_20px_rgba(59,130,246,0.6)]', glow: 'bg-blue-500' }, // Engineer
                { border: 'border-yellow-400', text: 'text-yellow-400', shadow: 'shadow-[0_0_25px_rgba(250,204,21,0.6)]', glow: 'bg-yellow-400' }, // Pilot
                { border: 'border-purple-500', text: 'text-purple-400', shadow: 'shadow-[0_0_30px_rgba(168,85,247,0.7)]', glow: 'bg-purple-500' } // Guardian
            ],
            
            init: () => {
                app.loadProgress();
                app.updateUI();
                starSystem.init();
                starSystem.animate();
                app.initCursor();
            },
            
            initCursor: () => {
                const dot = document.getElementById('cursor-dot');
                const ring = document.getElementById('cursor-ring');
                window.addEventListener('mousemove', (e) => {
                    dot.style.left = e.clientX + 'px'; dot.style.top = e.clientY + 'px';
                    setTimeout(() => { ring.style.left = e.clientX + 'px'; ring.style.top = e.clientY + 'px'; }, 50);
                });
                document.addEventListener('mouseover', (e) => {
                    if (e.target.tagName === 'BUTTON' || e.target.classList.contains('cursor-pointer') || e.target.closest('button')) document.body.classList.add('hovering');
                    else document.body.classList.remove('hovering');
                });
            },

            toggleLanguage: () => {
                app.state.lang = app.state.lang === 'en' ? 'hi' : 'en';
                document.getElementById('btn-en').classList.toggle('active');
                document.getElementById('btn-hi').classList.toggle('active');
                if(app.state.lang === 'hi') { document.body.classList.add('lang-hi'); document.body.classList.remove('lang-en'); } 
                else { document.body.classList.add('lang-en'); document.body.classList.remove('lang-hi'); }
                app.updateUI();
                if (app.state.currentView === 'dashboard') app.renderDashboard();
                if (app.state.currentView === 'mission-detail') app.showDashboard();
            },

            updateUI: () => {
                const t = i18n[app.state.lang];
                document.getElementById('nav-subtitle').innerText = t.navSubtitle;
                document.getElementById('btn-reset').innerText = t.resetData;
                document.getElementById('label-rank').innerText = t.currentRank;
                document.getElementById('warp-text').innerText = t.warpText;
                document.getElementById('landing-title').innerText = t.landingTitle;
                document.getElementById('landing-subtitle').innerText = t.landingSubtitle;
                document.getElementById('btn-start').querySelector('span').innerText = t.startBtn;
                document.getElementById('dashboard-title').innerText = t.dashboardTitle;
                document.getElementById('dashboard-subtitle').innerText = t.dashboardSubtitle;
                document.getElementById('btn-back').childNodes[2].nodeValue = " " + t.backToMap;
                document.getElementById('quiz-title').innerText = t.quizTitle;
                document.getElementById('quiz-subtitle').innerText = t.quizSubtitle;
                document.getElementById('rank-modal-subtitle').innerText = t.rankUpSub;
                document.querySelector('#rank-modal h2').innerText = t.rankUpTitle;
                app.updateRankVisuals();
            },

            saveProgress: () => {
                localStorage.setItem('starCadetProgress', JSON.stringify({ unlocked: app.state.unlockedMissions, rankIndex: app.state.rank, lang: app.state.lang }));
            },
            loadProgress: () => {
                const saved = localStorage.getItem('starCadetProgress');
                if (saved) {
                    const data = JSON.parse(saved);
                    app.state.unlockedMissions = data.unlocked;
                    app.state.rank = data.rankIndex || 0;
                }
            },
            resetProgress: () => {
                if(confirm("Reset Data?")) {
                    localStorage.removeItem('starCadetProgress');
                    app.state.unlockedMissions = 1;
                    app.state.rank = 0;
                    app.updateRankVisuals();
                    app.showDashboard();
                }
            },
            
            goHome: () => app.switchView('intro'),
            startJourney: () => app.animateWarp(() => app.showDashboard()),
            showDashboard: () => { app.renderDashboard(); app.switchView('dashboard'); },
            animateWarp: (callback) => {
                const warp = document.getElementById('warp-overlay');
                warp.classList.add('active'); starSystem.speedMultiplier = 60; 
                setTimeout(() => { callback(); setTimeout(() => { starSystem.speedMultiplier = 1; warp.classList.remove('active'); }, 800); }, 1500);
            },
            switchView: (viewName) => {
                app.state.currentView = viewName;
                document.querySelectorAll('section').forEach(el => el.classList.add('hidden-section'));
                const target = document.getElementById(`${viewName}-view`);
                target.classList.remove('hidden-section');
                target.classList.remove('fade-enter-active');
                void target.offsetWidth; target.classList.add('fade-enter-active');
                window.scrollTo(0,0);
            },

            unlockNextMission: (currentId) => {
                const missions = missionsData[app.state.lang];
                if (currentId === app.state.unlockedMissions) {
                    const oldRank = app.state.rank;
                    const t = i18n[app.state.lang];
                    
                    app.state.unlockedMissions++;
                    const newRankIndex = Math.min(app.state.unlockedMissions - 1, t.ranks.length - 1);
                    
                    app.state.rank = newRankIndex;
                    app.saveProgress();
                    
                    if (newRankIndex > oldRank) {
                        app.showRankUpModal(t.ranks[newRankIndex]);
                    } else {
                        app.updateRankVisuals();
                    }
                }
                app.closeQuiz();
                app.showDashboard();
            },

            showRankUpModal: (rankName) => {
                const modal = document.getElementById('rank-modal');
                document.getElementById('new-rank-name').innerText = rankName;
                modal.classList.remove('hidden');
                app.updateRankVisuals();
            },

            closeRankModal: () => {
                document.getElementById('rank-modal').classList.add('hidden');
            },

            updateRankVisuals: () => {
                const t = i18n[app.state.lang];
                const rankName = t.ranks[app.state.rank];
                const rankDisplay = document.getElementById('rank-display');
                rankDisplay.innerText = rankName;
                const style = app.rankColors[app.state.rank] || app.rankColors[0];
                const profileContainer = document.getElementById('profile-container');
                const profileGlow = document.getElementById('profile-glow');
                rankDisplay.className = `font-bold font-mono transition-colors duration-500 ${style.text}`;
                profileContainer.className = `w-12 h-12 rounded-full bg-slate-800 border-2 flex items-center justify-center relative overflow-hidden transition-all duration-500 ${style.border} ${style.shadow}`;
                profileGlow.className = `absolute inset-0 opacity-50 blur-md transition-colors duration-500 ${style.glow}`;
            },

             renderDashboard: () => {
                const list = document.getElementById('mission-list');
                list.innerHTML = '';
                const t = i18n[app.state.lang];
                const missions = missionsData[app.state.lang];

                missions.forEach((mission, index) => {
                    const isUnlocked = mission.id <= app.state.unlockedMissions;
                    const isCompleted = mission.id < app.state.unlockedMissions;
                    const alignClass = index % 2 === 0 ? 'md:flex-row' : 'md:flex-row-reverse';
                    const margin = index % 2 === 0 ? 'md:pr-12' : 'md:pl-12';
                    const unlockedClass = isUnlocked ? 'opacity-100' : 'opacity-50 grayscale';
                    const borderClass = isUnlocked ? `border-${mission.color}-500` : 'border-slate-700';
                    const safeColor = mission.color === 'neon-gold' ? 'yellow' : mission.color; 
                    const delay = (index + 1) * 150; 

                    let button = isUnlocked 
                        ? `<button onclick="app.loadMission(${mission.id})" class="mt-4 px-6 py-2 bg-${safeColor}-500/10 border border-${safeColor}-500 text-${safeColor}-400 clip-corners hover:bg-${safeColor}-500 hover:text-white transition-all text-sm font-bold uppercase tracking-wider shadow-[0_0_10px_rgba(0,0,0,0)] hover:shadow-[0_0_15px_currentColor]">
                            ${isCompleted ? t.accessLog : t.startMission}
                           </button>` 
                        : `<div class="mt-4 flex items-center gap-2 text-xs text-red-400 font-mono uppercase tracking-widest"><i class="ph-bold ph-lock-key"></i> ${t.locked}</div>`;

                    list.innerHTML += `
                        <div class="flex flex-col ${alignClass} items-center w-full relative group stagger-item" style="animation-delay: ${delay}ms">
                            <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-4 h-4 rounded-full ${isUnlocked ? `bg-${safeColor}-500 shadow-[0_0_15px_var(--neon-${safeColor})]` : 'bg-slate-700'} z-10 hidden md:block border-2 border-slate-900 transition-all"></div>
                            <div class="w-full md:w-5/12 ${margin} mb-8 md:mb-0 relative z-20">
                                <div class="glass-panel p-6 border-l-4 ${borderClass} ${unlockedClass} hover:scale-[1.02] transition-transform duration-300 clip-corners">
                                    <div class="flex justify-between items-start mb-2">
                                        <div class="inline-flex items-center justify-center w-10 h-10 bg-slate-800 text-${safeColor}-400 mb-3 border border-white/10"><i class="${mission.icon} text-xl"></i></div>
                                        ${isCompleted ? '<i class="ph-fill ph-check-circle text-green-400 text-2xl drop-shadow-[0_0_5px_rgba(74,222,128,0.8)]"></i>' : ''}
                                    </div>
                                    <h3 class="text-2xl font-bold text-white mb-1 orbitron">${t.missionPrefix} 0${mission.id}</h3>
                                    <h4 class="text-lg text-${safeColor}-400 font-semibold mb-2 font-mono">${mission.title}</h4>
                                    <p class="text-sm text-gray-400 leading-relaxed mb-4">${mission.description}</p>
                                    ${button}
                                </div>
                            </div>
                        </div>
                    `;
                });
            },
            
            loadMission: (id) => {
                app.animateWarp(() => {
                    const missions = missionsData[app.state.lang];
                    const mission = missions.find(m => m.id === id);
                    const container = document.getElementById('mission-content-area');
                    const t = i18n[app.state.lang];
                    const safeColor = mission.color === 'neon-gold' ? 'yellow' : mission.color;
                    
                    let contentHTML = `
                        <div class="relative glass-panel overflow-hidden mb-8 shadow-[0_0_30px_rgba(0,0,0,0.5)] border-t border-${safeColor}-500 stagger-item" style="animation-delay: 100ms">
                            <div class="p-8 md:p-12 relative">
                                <div class="absolute top-0 right-0 p-4 opacity-10"><i class="${mission.icon} text-9xl text-white"></i></div>
                                <div class="flex items-center gap-4 mb-6 relative z-10">
                                    <i class="${mission.icon} text-4xl text-${safeColor}-400 animate-pulse"></i>
                                    <div>
                                        <h2 class="text-4xl md:text-5xl font-black text-white orbitron" id="mission-title-anim">${mission.title.toUpperCase()}</h2>
                                        <p class="text-xl text-${safeColor}-300 font-light tracking-wide font-mono">${mission.subtitle}</p>
                                    </div>
                                </div>
                                <p class="text-lg md:text-xl text-gray-300 border-l-2 border-${safeColor}-500/50 pl-4 italic max-w-3xl relative z-10">${mission.content.intro}</p>
                            </div>
                        </div>
                    `;

                    mission.content.sections.forEach((section, sIdx) => {
                        const delay = (sIdx + 2) * 150;
                        contentHTML += `
                            <div class="mb-12 stagger-item" style="animation-delay: ${delay}ms">
                                <h3 class="text-2xl font-bold text-white mb-4 flex items-center gap-3">
                                    <span class="w-8 h-1 bg-${safeColor}-500 rounded-full box-shadow-glow"></span>
                                    ${section.title}
                                </h3>
                                <p class="text-gray-300 mb-6 text-lg pl-11">${section.text}</p>
                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 pl-0 md:pl-11">
                                    ${section.cards.map((card, cIdx) => `
                                        <div onclick="app.showDetail(${id}, ${sIdx}, ${cIdx})" class="cursor-pointer bg-slate-800/40 border border-white/5 p-5 hover:bg-slate-800/80 hover:border-${safeColor}-500/50 transition-all group relative overflow-hidden clip-corners">
                                            <div class="absolute top-0 right-0 p-2 opacity-0 group-hover:opacity-100 transition-opacity"><i class="ph-bold ph-info text-${safeColor}-400"></i></div>
                                            <i class="${card.icon} text-3xl text-${safeColor}-400 mb-3 group-hover:scale-110 transition-transform block drop-shadow-md"></i>
                                            <h4 class="font-bold text-white mb-1 group-hover:text-${safeColor}-300 transition-colors font-mono">${card.name}</h4>
                                            <p class="text-xs text-gray-400 leading-relaxed">${card.detail}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `;
                    });

                    const isCompleted = app.state.unlockedMissions > id;
                    contentHTML += `
                        <div class="mt-16 text-center py-12 border-t border-white/10 stagger-item" style="animation-delay: 800ms">
                            <button onclick="app.openQuiz(${id})" class="px-10 py-4 bg-gradient-to-r from-${safeColor}-600 to-${safeColor}-400 text-black font-bold clip-corners shadow-lg shadow-${safeColor}-500/30 hover:shadow-${safeColor}-500/50 hover:scale-105 transition-all text-lg flex items-center gap-2 mx-auto">
                                <i class="ph-bold ph-check-square"></i>
                                ${isCompleted ? t.practice : t.complete}
                            </button>
                        </div>
                    `;

                    container.innerHTML = contentHTML;
                    app.switchView('mission-detail');
                    const titleEl = document.getElementById('mission-title-anim');
                    if(titleEl && app.state.lang === 'en') app.scrambleText(titleEl, mission.title.toUpperCase());
                });
            },
            
            showDetail: (mId, sId, cId) => {
                const missions = missionsData[app.state.lang];
                const mission = missions.find(m => m.id === mId);
                const item = mission.content.sections[sId].cards[cId];
                const modal = document.getElementById('detail-modal');
                const content = document.getElementById('detail-content');
                const safeColor = mission.color === 'neon-gold' ? 'yellow' : mission.color;
                const t = i18n[app.state.lang];
                let statsHTML = '';
                for (const [key, value] of Object.entries(item.stats)) {
                    statsHTML += `<div class="bg-black/40 p-3 border-l-2 border-${safeColor}-500"><div class="text-xs text-gray-500 uppercase tracking-wider font-bold">${key}</div><div class="text-white font-mono text-lg text-${safeColor}-300">${value}</div></div>`;
                }
                content.innerHTML = `
                    <div class="md:w-1/3 bg-slate-900/80 p-8 flex items-center justify-center border-b md:border-b-0 md:border-r border-white/10 relative overflow-hidden">
                        <div class="absolute inset-0 bg-${safeColor}-500/5 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-30"></div>
                        <i class="${item.icon} text-9xl text-${safeColor}-400 relative z-10 animate-float drop-shadow-[0_0_30px_rgba(255,255,255,0.2)]"></i>
                    </div>
                    <div class="md:w-2/3 p-8 relative">
                        <div class="absolute top-4 right-4 flex gap-1"><div class="w-12 h-1 bg-${safeColor}-500/50"></div><div class="w-2 h-1 bg-${safeColor}-500/50"></div></div>
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="text-4xl font-bold text-white orbitron tracking-wide" id="detail-title">${item.name}</h3>
                                <span class="px-2 py-1 bg-${safeColor}-500/20 text-${safeColor}-300 text-xs border border-${safeColor}-500/50 uppercase font-bold tracking-widest mt-2 inline-block">${item.type}</span>
                            </div>
                        </div>
                        <p class="text-gray-300 text-lg mb-8 leading-relaxed">${item.detail}</p>
                        <h4 class="text-sm font-bold text-gray-400 uppercase mb-4 border-b border-gray-700 pb-2">${t.systemAnalysis}</h4>
                        <div class="grid grid-cols-2 gap-4">${statsHTML}</div>
                    </div>
                `;
                modal.classList.remove('hidden');
                if(app.state.lang === 'en') app.scrambleText(document.getElementById('detail-title'), item.name);
            },
            closeDetail: () => document.getElementById('detail-modal').classList.add('hidden'),
            
            // --- UPDATED QUIZ LOGIC ---
            openQuiz: (missionId) => {
                const missions = missionsData[app.state.lang];
                const mission = missions.find(m => m.id === missionId);
                const modal = document.getElementById('quiz-modal');
                const feedback = document.getElementById('quiz-feedback');
                
                // Initialize Quiz State
                app.state.activeQuiz = {
                    missionId: missionId,
                    currentQuestion: 0,
                    score: 0
                };

                feedback.classList.add('hidden');
                modal.classList.remove('hidden');
                app.renderQuizQuestion();
            },

            renderQuizQuestion: () => {
                const { missionId, currentQuestion } = app.state.activeQuiz;
                const missions = missionsData[app.state.lang];
                const mission = missions.find(m => m.id === missionId);
                const questionData = mission.quiz[currentQuestion];
                const container = document.getElementById('quiz-question-container');
                const feedback = document.getElementById('quiz-feedback');
                const progressEl = document.getElementById('quiz-progress');
                
                // Update Progress Bar
                const percent = (currentQuestion / mission.quiz.length) * 100;
                progressEl.style.width = `${percent}%`;

                // Reset Feedback
                feedback.classList.add('hidden');
                feedback.innerHTML = '';

                let optionsHTML = '';
                questionData.options.forEach((opt, idx) => {
                    optionsHTML += `
                        <button onclick="app.checkAnswer(${idx}, this)" class="w-full text-left p-4 bg-slate-800/50 hover:bg-slate-700 border border-slate-600 mb-3 transition-all flex items-center justify-between group clip-corners">
                            <span class="text-gray-200 group-hover:text-white font-mono text-lg">${opt}</span>
                            <div class="w-5 h-5 border border-slate-500 group-hover:border-cyan-400 transition-colors bg-black"></div>
                        </button>
                    `;
                });

                container.innerHTML = `
                    <div class="flex justify-between items-center mb-4 text-xs text-cyan-400 font-mono tracking-widest">
                        <span>QUESTION ${currentQuestion + 1} / ${mission.quiz.length}</span>
                        <span>MISSION ${missionId}</span>
                    </div>
                    <p class="text-xl font-medium text-white mb-8 leading-relaxed animate-fade-in">${questionData.question}</p>
                    <div class="space-y-3">${optionsHTML}</div>
                `;
            },
            
            checkAnswer: (selectedIdx, btnElement) => {
                const { missionId, currentQuestion } = app.state.activeQuiz;
                const missions = missionsData[app.state.lang];
                const mission = missions.find(m => m.id === missionId);
                const questionData = mission.quiz[currentQuestion];
                const isCorrect = selectedIdx === questionData.correct;
                const feedback = document.getElementById('quiz-feedback');
                const t = i18n[app.state.lang];
                const container = document.getElementById('quiz-question-container');
                
                // Disable all inputs
                container.querySelectorAll('button').forEach(btn => { 
                    btn.disabled = true; 
                    btn.classList.add('opacity-50'); 
                });
                btnElement.classList.remove('opacity-50');

                if (isCorrect) {
                    btnElement.classList.remove('bg-slate-800/50', 'border-slate-600');
                    btnElement.classList.add('bg-green-500/20', 'border-green-500');
                    btnElement.querySelector('div').classList.add('bg-green-500');
                    
                    const isLastQuestion = currentQuestion === mission.quiz.length - 1;
                    const isNewUnlock = app.state.unlockedMissions === missionId && isLastQuestion;
                    
                    // Intel Data HTML
                    const intelHTML = `
                        <div class="mt-2 mb-4 p-3 bg-cyan-900/20 border-l-2 border-cyan-400 text-left text-sm text-cyan-100">
                            <strong class="block text-xs uppercase tracking-widest text-cyan-400 mb-1">${t.intel}</strong>
                            ${questionData.explanation}
                        </div>
                    `;

                    let actionButton = '';
                    if(isLastQuestion) {
                        if(isNewUnlock) {
                            actionButton = `<button onclick="app.unlockNextMission(${missionId})" class="w-full px-8 py-3 bg-green-500 text-black font-bold clip-corners hover:bg-green-400 hover:scale-105 transition-all shadow-lg shadow-green-900/50 mt-2">${t.nextMission}</button>`;
                        } else {
                            actionButton = `<button onclick="app.closeQuiz()" class="w-full px-6 py-3 bg-gray-600 text-white font-bold clip-corners hover:bg-gray-500 mt-2">${t.close}</button>`;
                        }
                    } else {
                        actionButton = `<button onclick="app.nextQuestion()" class="w-full px-8 py-3 bg-cyan-500 text-black font-bold clip-corners hover:bg-cyan-400 mt-2">${t.nextQ}</button>`;
                    }

                    feedback.innerHTML = `
                        <div class="text-green-400 font-bold text-xl mb-2 flex items-center justify-center gap-2 orbitron">
                            <i class="ph-fill ph-check-circle"></i> ${t.verified}
                        </div>
                        ${intelHTML}
                        ${actionButton}
                    `;
                } else {
                    btnElement.classList.remove('bg-slate-800/50', 'border-slate-600');
                    btnElement.classList.add('bg-red-500/20', 'border-red-500');
                    feedback.innerHTML = `
                        <div class="text-red-400 font-bold text-xl mb-2 flex items-center justify-center gap-2 orbitron">
                            <i class="ph-fill ph-warning-circle"></i> ${t.error}
                        </div>
                        <p class="text-sm text-gray-300 mb-4">${t.errorMsg}</p>
                        <button onclick="app.renderQuizQuestion()" class="w-full px-6 py-2 bg-red-500/20 text-red-300 border border-red-500 clip-corners hover:bg-red-500 hover:text-white transition-all">${t.retry}</button>
                    `;
                }
                feedback.classList.remove('hidden');
            },

            nextQuestion: () => {
                app.state.activeQuiz.currentQuestion++;
                app.renderQuizQuestion();
            },
            
            scrambleText: (element, finalValue) => {
                let iterations = 0;
                const interval = setInterval(() => {
                    element.innerText = finalValue.split("").map((char, index) => { if(index < iterations) return finalValue[index]; return "ABCDEF0123456789"[Math.floor(Math.random() * 16)]; }).join("");
                    if(iterations >= finalValue.length) clearInterval(interval);
                    iterations += 1/3; 
                }, 30);
            },
            closeQuiz: () => document.getElementById('quiz-modal').classList.add('hidden')
        };

        const starSystem = {
            canvas: document.getElementById('star-canvas'),
            ctx: document.getElementById('star-canvas').getContext('2d'),
            width: 0, height: 0, stars: [], numStars: 200, speedMultiplier: 1, mouse: { x: 0, y: 0 },
            init: () => {
                starSystem.width = window.innerWidth; starSystem.height = window.innerHeight;
                starSystem.canvas.width = starSystem.width; starSystem.canvas.height = starSystem.height;
                starSystem.mouse.x = starSystem.width / 2; starSystem.mouse.y = starSystem.height / 2;
                starSystem.stars = [];
                for (let i = 0; i < starSystem.numStars; i++) { starSystem.stars.push(starSystem.createStar()); }
            },
            createStar: () => ({ x: Math.random() * starSystem.width - starSystem.width / 2, y: Math.random() * starSystem.height - starSystem.height / 2, z: Math.random() * starSystem.width, isShooting: false }),
            animate: () => {
                const { ctx, width, height, stars } = starSystem;
                ctx.fillStyle = starSystem.speedMultiplier > 1 ? 'rgba(5, 11, 20, 0.2)' : 'rgba(5, 11, 20, 1)';
                ctx.fillRect(0, 0, width, height);
                const offsetX = (starSystem.mouse.x - width / 2) * 0.1; const offsetY = (starSystem.mouse.y - height / 2) * 0.1;

                if (Math.random() > 0.98 && starSystem.speedMultiplier === 1) {
                    stars.push({ x: Math.random() * width - width / 2, y: Math.random() * height - height / 2, z: Math.random() * width / 2, isShooting: true, vx: (Math.random() - 0.5) * 50, vy: (Math.random() - 0.5) * 50 });
                }

                for(let i = 0; i < stars.length; i++) {
                    let star = stars[i];
                    if (star.isShooting) {
                        star.x += star.vx; star.y += star.vy; star.z -= 10;
                        if (star.z <= 0 || Math.abs(star.x) > width || Math.abs(star.y) > height) { stars.splice(i, 1); i--; continue; }
                        const k = 128.0 / star.z; const px = (star.x - offsetX) * k + width / 2; const py = (star.y - offsetY) * k + height / 2; const size = (1 - star.z / width) * 3;
                        ctx.beginPath(); ctx.strokeStyle = `rgba(255, 255, 255, ${1 - star.z/width})`; ctx.lineWidth = size; ctx.moveTo(px, py); ctx.lineTo(px - star.vx*2, py - star.vy*2); ctx.stroke(); continue;
                    }
                    star.z -= (1 * starSystem.speedMultiplier);
                    if (star.z <= 0) { star.z = width; star.x = Math.random() * width - width / 2; star.y = Math.random() * height - height / 2; }
                    const k = 128.0 / star.z; const px = (star.x - offsetX) * k + width / 2; const py = (star.y - offsetY) * k + height / 2; let size = (1 - star.z / width) * 2; let opacity = (1 - star.z / width);
                    if (px >= 0 && px <= width && py >= 0 && py <= height) {
                        ctx.beginPath();
                        if (starSystem.speedMultiplier > 10) {
                            const prevK = 128.0 / (star.z + 150); const prevPx = (star.x - offsetX) * prevK + width / 2; const prevPy = (star.y - offsetY) * prevK + height / 2;
                            ctx.strokeStyle = `rgba(34, 211, 238, ${opacity})`; ctx.lineWidth = size * 1.5; ctx.moveTo(prevPx, prevPy); ctx.lineTo(px, py); ctx.stroke();
                        } else {
                            ctx.fillStyle = `rgba(200, 220, 255, ${opacity})`; ctx.arc(px, py, size, 0, Math.PI * 2); ctx.fill();
                            if(size > 1.5) { ctx.shadowBlur = 10; ctx.shadowColor = "white"; } else { ctx.shadowBlur = 0; }
                        }
                        ctx.shadowBlur = 0; 
                    }
                }
                requestAnimationFrame(starSystem.animate);
            }
        };

        window.addEventListener('resize', starSystem.init);
        app.init(); 
    </script>
</body>
</html>